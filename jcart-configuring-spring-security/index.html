
<!DOCTYPE html>
<html lang="en">
	
<head>
	<link href="http://gmpg.org/xfn/11" rel="profile">
  	<meta http-equiv="content-type" content="text/html; charset=utf-8">
  	<meta name="generator" content="Hugo 0.15" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>SivaLabs &middot; JCart: Configuring Spring Security</title>
    
    
    <link href="http://sivalabs.github.io/css/asciidoctor-default.css" rel="stylesheet">
    <link href="http://sivalabs.github.io/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://sivalabs.github.io/css/font-awesome.min.css" rel="stylesheet">
    <link href="http://sivalabs.github.io/css/prettyPhoto.css" rel="stylesheet">
    <link href="http://sivalabs.github.io/css/animate.min.css" rel="stylesheet">
    <link href="http://sivalabs.github.io/css/main.css" rel="stylesheet">
    <link href="http://sivalabs.github.io/css/responsive.css" rel="stylesheet">
    
    
    
           
    
    <link rel="shortcut icon" href="http://sivalabs.github.io/favicon.png" type="image/x-icon">
    
    
    
  <link href="" rel="alternate" type="application/rss+xml" title="SivaLabs" />
</head>

	<body>
		<header id="header">

    <nav class="navbar navbar-inverse navbar-fixed-top" role="banner">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="http://sivalabs.github.io/">SivaLabs</a>
            </div>
            
            <div class="collapse navbar-collapse navbar-right">
                <ul class="nav navbar-nav">
                    <li><a href="http://sivalabs.github.io/">Home</a></li>
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Trainings <i class="fa fa-angle-down"></i></a>
                        <ul class="dropdown-menu">
                            <li><a href="http://sivalabs.github.io/core-java">Core Java</a></li>
                            <li><a href="http://sivalabs.github.io/spring">Spring</a></li>
                            <li><a href="http://sivalabs.github.io/java-ee">JavaEE</a></li>
                            
                        </ul>
                    </li>
                    <li><a href="http://sivalabs.github.io/freelancing">Freelancing</a></li>
                    <li><a href="http://sivalabs.github.io/contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>
    
</header>

		<section id="blog" class="container page-container">
        
        <div class="blog">
            <div class="row">
                <div class="col-md-9">
                    <div class="blog-item">
		                	
                            <div class="row">  
                                
                                <div class="col-xs-12 col-sm-12 blog-content">
                                	<div>
				                		<p><a href="http://sivalabs.github.io/">Home</a> <i class="fa fa-angle-double-right"></i> <span>JCart: Configuring Spring Security</span></p>
				                	</div>
                                    <h2>JCart: Configuring Spring Security</h2>
                                    <div class="">
	                                    <span><i class="fa fa-user"></i> Siva</span>&nbsp;&nbsp;
                                        <span><i class="fa fa-calendar"></i> Dec 1, 2015</span>
                                    </div>

                                    <div class="post-tags">
                                        <strong>Tags: </strong> 
                                        
                                        	<a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/e-commerce" rel="category">
										    	E-Commerce &nbsp;&nbsp;
										    </a>
									  	
                                        	<a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/java" rel="category">
										    	Java &nbsp;&nbsp;
										    </a>
									  	
                                        	<a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/jcart" rel="category">
										    	JCart &nbsp;&nbsp;
										    </a>
									  	
                                        	<a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/spring" rel="category">
										    	Spring &nbsp;&nbsp;
										    </a>
									  	
                                        	<a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/springboot" rel="category">
										    	SpringBoot &nbsp;&nbsp;
										    </a>
									  	
                                        
                                    </div>
                                    <br/>
                                    <p><div class="paragraph">
<p>Our JCart Administration site should only be accessible to authorized users only. So, we are going to use SpringSecurity to define the security constraints.</p>
</div>
<div class="paragraph">
<p>Let us add the following spring-security dependencies to <strong>jcart-admin/pom.xml</strong>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px">1
2
3
4
5
6
7
8</div></td><td class="code"><span style="color: #008000; font-weight: bold">&lt;dependency&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;groupid&gt;</span>org.springframework.boot<span style="color: #008000; font-weight: bold">&lt;/groupid&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;artifactid&gt;</span>spring-boot-starter-security<span style="color: #008000; font-weight: bold">&lt;/artifactid&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dependency&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;dependency&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;groupid&gt;</span>org.thymeleaf.extras<span style="color: #008000; font-weight: bold">&lt;/groupid&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;artifactid&gt;</span>thymeleaf-extras-springsecurity4<span style="color: #008000; font-weight: bold">&lt;/artifactid&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/dependency&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>If we have predefined set of Roles then we can specify the URL patterns and its required Roles
something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px">1
2
3
4
5
6</div></td><td class="code">http
<span style="color: #666666">.</span><span style="color: #7D9029">authorizeRequests</span><span style="color: #666666">()</span>
    <span style="color: #666666">.</span><span style="color: #7D9029">antMatchers</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/login&quot;</span><span style="color: #666666">,</span><span style="color: #BA2121">&quot;/login/form**&quot;</span><span style="color: #666666">,</span><span style="color: #BA2121">&quot;/register&quot;</span><span style="color: #666666">,</span><span style="color: #BA2121">&quot;/logout&quot;</span><span style="color: #666666">).</span><span style="color: #7D9029">permitAll</span><span style="color: #666666">()</span>
    <span style="color: #666666">.</span><span style="color: #7D9029">antMatchers</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/admin&quot;</span><span style="color: #666666">,</span><span style="color: #BA2121">&quot;/admin/**&quot;</span><span style="color: #666666">).</span><span style="color: #7D9029">hasRole</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;ADMIN&quot;</span><span style="color: #666666">)</span>
    <span style="color: #666666">.</span><span style="color: #7D9029">anyRequest</span><span style="color: #666666">().</span><span style="color: #7D9029">authenticated</span><span style="color: #666666">()</span>
    <span style="color: #666666">.</span><span style="color: #7D9029">and</span><span style="color: #666666">()</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>But we need provision to dynamically create new roles as well, hence we can&#8217;t statically
define constraints using role names.</p>
</div>
<div class="paragraph">
<p>But in our JCart application, we have fixed list of permissions and then grouped them as Roles.
So we can configure SpringSecurity to use Method Level Security by checking the permissions.</p>
</div>
<div class="paragraph">
<p>SpringSecurity don&#8217;t have the support for Permissions. So we will follow suggestion given here
<a href="http://springinpractice.com/2010/10/27/quick-tip-spring-security-role-based-authorization-and-permissions" class="bare">http://springinpractice.com/2010/10/27/quick-tip-spring-security-role-based-authorization-and-permissions</a>
where we consider the Permissions as Roles.</p>
</div>
<div class="sect2">
<h3 id="_userrepository_to_get_user_by_email">UserRepository to get User by Email</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px">1
2
3
4</div></td><td class="code"><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">interface</span> <span style="color: #0000FF; font-weight: bold">UserRepository</span> <span style="color: #008000; font-weight: bold">extends</span> JpaRepository<span style="color: #666666">&lt;</span>User<span style="color: #666666">,</span> Integer<span style="color: #666666">&gt;</span>
<span style="color: #666666">{</span>
	User <span style="color: #0000FF">findByEmail</span><span style="color: #666666">(</span>String email<span style="color: #666666">);</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_securityservice_facade_to_all_security_related_methods">SecurityService - Facade to all Security Related Methods</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</div></td><td class="code"><span style="color: #AA22FF">@Service</span>
<span style="color: #AA22FF">@Transactional</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">SecurityService</span>
<span style="color: #666666">{</span>
	<span style="color: #AA22FF">@Autowired</span> UserRepository userRepository<span style="color: #666666">;</span>

	<span style="color: #008000; font-weight: bold">public</span> User <span style="color: #0000FF">findUserByEmail</span><span style="color: #666666">(</span>String email<span style="color: #666666">)</span>
	<span style="color: #666666">{</span>
    		<span style="color: #008000; font-weight: bold">return</span> userRepository<span style="color: #666666">.</span><span style="color: #7D9029">findByEmail</span><span style="color: #666666">(</span>email<span style="color: #666666">);</span>
	<span style="color: #666666">}</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_wrapper_for_springsecurity_user">Wrapper for SpringSecurity User</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</div></td><td class="code"><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">AuthenticatedUser</span> <span style="color: #008000; font-weight: bold">extends</span> org<span style="color: #666666">.</span><span style="color: #7D9029">springframework</span><span style="color: #666666">.</span><span style="color: #7D9029">security</span><span style="color: #666666">.</span><span style="color: #7D9029">core</span><span style="color: #666666">.</span><span style="color: #7D9029">userdetails</span><span style="color: #666666">.</span><span style="color: #7D9029">User</span>
<span style="color: #666666">{</span>
	<span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #008000; font-weight: bold">final</span> <span style="color: #B00040">long</span> serialVersionUID <span style="color: #666666">=</span> <span style="color: #666666">1L;</span>
	<span style="color: #008000; font-weight: bold">private</span> User user<span style="color: #666666">;</span>

	<span style="color: #008000; font-weight: bold">public</span> <span style="color: #0000FF">AuthenticatedUser</span><span style="color: #666666">(</span>User user<span style="color: #666666">)</span>
	<span style="color: #666666">{</span>
	    <span style="color: #008000; font-weight: bold">super</span><span style="color: #666666">(</span>user<span style="color: #666666">.</span><span style="color: #7D9029">getEmail</span><span style="color: #666666">(),</span> user<span style="color: #666666">.</span><span style="color: #7D9029">getPassword</span><span style="color: #666666">(),</span> getAuthorities<span style="color: #666666">(</span>user<span style="color: #666666">));</span>
	    <span style="color: #008000; font-weight: bold">this</span><span style="color: #666666">.</span><span style="color: #7D9029">user</span> <span style="color: #666666">=</span> user<span style="color: #666666">;</span>
	<span style="color: #666666">}</span>

	<span style="color: #008000; font-weight: bold">public</span> User <span style="color: #0000FF">getUser</span><span style="color: #666666">()</span>
	<span style="color: #666666">{</span>
	    <span style="color: #008000; font-weight: bold">return</span> user<span style="color: #666666">;</span>
	<span style="color: #666666">}</span>

	<span style="color: #008000; font-weight: bold">private</span> <span style="color: #008000; font-weight: bold">static</span> Collection<span style="color: #666666">&lt;?</span> <span style="color: #008000; font-weight: bold">extends</span> GrantedAuthority<span style="color: #666666">&gt;</span> <span style="color: #0000FF">getAuthorities</span><span style="color: #666666">(</span>User user<span style="color: #666666">)</span>
	<span style="color: #666666">{</span>
		Set<span style="color: #666666">&lt;</span>String<span style="color: #666666">&gt;</span> roleAndPermissions <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> HashSet<span style="color: #666666">&lt;&gt;();</span>
		List<span style="color: #666666">&lt;</span>Role<span style="color: #666666">&gt;</span> roles <span style="color: #666666">=</span> user<span style="color: #666666">.</span><span style="color: #7D9029">getRoles</span><span style="color: #666666">();</span>
		<span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span>Role role <span style="color: #666666">:</span> roles<span style="color: #666666">)</span>
		<span style="color: #666666">{</span>
			roleAndPermissions<span style="color: #666666">.</span><span style="color: #7D9029">add</span><span style="color: #666666">(</span>role<span style="color: #666666">.</span><span style="color: #7D9029">getName</span><span style="color: #666666">());</span>
			List<span style="color: #666666">&lt;</span>Permission<span style="color: #666666">&gt;</span> permissions <span style="color: #666666">=</span> role<span style="color: #666666">.</span><span style="color: #7D9029">getPermissions</span><span style="color: #666666">();</span>
			<span style="color: #008000; font-weight: bold">for</span> <span style="color: #666666">(</span>Permission permission <span style="color: #666666">:</span> permissions<span style="color: #666666">)</span>
			<span style="color: #666666">{</span>
				roleAndPermissions<span style="color: #666666">.</span><span style="color: #7D9029">add</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;ROLE_&quot;</span><span style="color: #666666">+</span>permission<span style="color: #666666">.</span><span style="color: #7D9029">getName</span><span style="color: #666666">());</span>
			<span style="color: #666666">}</span>
			String<span style="color: #666666">[]</span> roleNames <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">new</span> String<span style="color: #666666">[</span>roleAndPermissions<span style="color: #666666">.</span><span style="color: #7D9029">size</span><span style="color: #666666">()];</span>
			Collection<span style="color: #666666">&lt;</span>GrantedAuthority<span style="color: #666666">&gt;</span> authorities <span style="color: #666666">=</span>
				AuthorityUtils
					<span style="color: #666666">.</span><span style="color: #7D9029">createAuthorityList</span><span style="color: #666666">(</span>
						roleAndPermissions<span style="color: #666666">.</span><span style="color: #7D9029">toArray</span><span style="color: #666666">(</span>roleNames<span style="color: #666666">)</span>
						<span style="color: #666666">);</span>
			<span style="color: #008000; font-weight: bold">return</span> authorities<span style="color: #666666">;</span>
		<span style="color: #666666">}</span>
	<span style="color: #666666">}</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_custom_userdetailsservice_implementation">Custom UserDetailsService Implementation</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</div></td><td class="code"><span style="color: #AA22FF">@Service</span>
<span style="color: #AA22FF">@Transactional</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">CustomUserDetailsService</span> <span style="color: #008000; font-weight: bold">implements</span> UserDetailsService
<span style="color: #666666">{</span>
	<span style="color: #AA22FF">@Autowired</span>
	<span style="color: #008000; font-weight: bold">private</span> SecurityService securityService<span style="color: #666666">;</span>

	<span style="color: #AA22FF">@Override</span>
	<span style="color: #008000; font-weight: bold">public</span> UserDetails <span style="color: #0000FF">loadUserByUsername</span><span style="color: #666666">(</span>String userName<span style="color: #666666">)</span>
	<span style="color: #008000; font-weight: bold">throws</span> UsernameNotFoundException <span style="color: #666666">{</span>
	User user <span style="color: #666666">=</span> securityService<span style="color: #666666">.</span><span style="color: #7D9029">findUserByEmail</span><span style="color: #666666">(</span>userName<span style="color: #666666">);</span>
	<span style="color: #008000; font-weight: bold">if</span><span style="color: #666666">(</span>user <span style="color: #666666">==</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">){</span>
	<span style="color: #008000; font-weight: bold">throw</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">UsernameNotFoundException</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;Email &quot;</span><span style="color: #666666">+</span>userName<span style="color: #666666">+</span><span style="color: #BA2121">&quot; not found&quot;</span><span style="color: #666666">);</span>
	<span style="color: #666666">}</span>
	<span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">AuthenticatedUser</span><span style="color: #666666">(</span>user<span style="color: #666666">);</span>
	<span style="color: #666666">}</span>

<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_springsecurity_configuration">SpringSecurity Configuration</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42</div></td><td class="code"><span style="color: #AA22FF">@Configuration</span>
<span style="color: #AA22FF">@EnableWebSecurity</span>
<span style="color: #AA22FF">@EnableGlobalMethodSecurity</span><span style="color: #666666">(</span>securedEnabled <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">,</span> proxyTargetClass <span style="color: #666666">=</span> <span style="color: #008000; font-weight: bold">true</span><span style="color: #666666">)</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WebSecurityConfig</span> <span style="color: #008000; font-weight: bold">extends</span> WebSecurityConfigurerAdapter <span style="color: #666666">{</span>

	<span style="color: #AA22FF">@Autowired</span>
	<span style="color: #008000; font-weight: bold">private</span> UserDetailsService customUserDetailsService<span style="color: #666666">;</span>

	<span style="color: #AA22FF">@Bean</span>
    <span style="color: #008000; font-weight: bold">public</span> PasswordEncoder <span style="color: #0000FF">passwordEncoder</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">BCryptPasswordEncoder</span><span style="color: #666666">();</span>
    <span style="color: #666666">}</span>

	<span style="color: #AA22FF">@Autowired</span>
    <span style="color: #008000; font-weight: bold">public</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">configureGlobal</span><span style="color: #666666">(</span>AuthenticationManagerBuilder auth<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        auth
        	<span style="color: #666666">.</span><span style="color: #7D9029">userDetailsService</span><span style="color: #666666">(</span>customUserDetailsService<span style="color: #666666">)</span>
        	<span style="color: #666666">.</span><span style="color: #7D9029">passwordEncoder</span><span style="color: #666666">(</span>passwordEncoder<span style="color: #666666">());</span>
    <span style="color: #666666">}</span>

    <span style="color: #AA22FF">@Override</span>
    <span style="color: #008000; font-weight: bold">protected</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">configure</span><span style="color: #666666">(</span>HttpSecurity http<span style="color: #666666">)</span> <span style="color: #008000; font-weight: bold">throws</span> Exception <span style="color: #666666">{</span>
        http
        	<span style="color: #666666">.</span><span style="color: #7D9029">csrf</span><span style="color: #666666">().</span><span style="color: #7D9029">disable</span><span style="color: #666666">()</span>
            <span style="color: #666666">.</span><span style="color: #7D9029">authorizeRequests</span><span style="color: #666666">()</span>
            	<span style="color: #666666">.</span><span style="color: #7D9029">antMatchers</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/resources/**&quot;</span><span style="color: #666666">,</span> <span style="color: #BA2121">&quot;/webjars/**&quot;</span><span style="color: #666666">,</span><span style="color: #BA2121">&quot;/assets/**&quot;</span><span style="color: #666666">).</span><span style="color: #7D9029">permitAll</span><span style="color: #666666">()</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">antMatchers</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/&quot;</span><span style="color: #666666">,</span> <span style="color: #BA2121">&quot;/forgotPwd&quot;</span><span style="color: #666666">,</span><span style="color: #BA2121">&quot;/resetPwd&quot;</span><span style="color: #666666">).</span><span style="color: #7D9029">permitAll</span><span style="color: #666666">()</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">anyRequest</span><span style="color: #666666">().</span><span style="color: #7D9029">authenticated</span><span style="color: #666666">()</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">and</span><span style="color: #666666">()</span>
            <span style="color: #666666">.</span><span style="color: #7D9029">formLogin</span><span style="color: #666666">()</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">loginPage</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/login&quot;</span><span style="color: #666666">)</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">defaultSuccessUrl</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/home&quot;</span><span style="color: #666666">)</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">failureUrl</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/login?error&quot;</span><span style="color: #666666">)</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">permitAll</span><span style="color: #666666">()</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">and</span><span style="color: #666666">()</span>
            <span style="color: #666666">.</span><span style="color: #7D9029">logout</span><span style="color: #666666">()</span>
            	<span style="color: #666666">.</span><span style="color: #7D9029">logoutRequestMatcher</span><span style="color: #666666">(</span><span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">AntPathRequestMatcher</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/logout&quot;</span><span style="color: #666666">))</span>
            	<span style="color: #666666">.</span><span style="color: #7D9029">permitAll</span><span style="color: #666666">()</span>
                <span style="color: #666666">.</span><span style="color: #7D9029">and</span><span style="color: #666666">()</span>
            <span style="color: #666666">.</span><span style="color: #7D9029">exceptionHandling</span><span style="color: #666666">().</span><span style="color: #7D9029">accessDeniedPage</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/403&quot;</span><span style="color: #666666">);</span>
    <span style="color: #666666">}</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_access_denied_exception_handler">Access Denied Exception Handler</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span style="color: #AA22FF">@Controller</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">ErrorController</span>
<span style="color: #666666">{</span>
	<span style="color: #AA22FF">@RequestMapping</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;/403&quot;</span><span style="color: #666666">)</span>
	<span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">accessDenied</span><span style="color: #666666">()</span>
	<span style="color: #666666">{</span>
	<span style="color: #008000; font-weight: bold">return</span> <span style="color: #BA2121">&quot;error/accessDenied&quot;</span><span style="color: #666666">;</span>
	<span style="color: #666666">}</span>

<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_abstract_controller_with_common_methods">Abstract Controller with Common Methods</h3>
<div class="paragraph">
<p>Let us create a base Abstract Controller to have the common methods by all controllers.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</div></td><td class="code"><span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">abstract</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">JCartAdminBaseController</span>
<span style="color: #666666">{</span>
	<span style="color: #AA22FF">@Autowired</span> <span style="color: #008000; font-weight: bold">protected</span> MessageSource messageSource<span style="color: #666666">;</span>

	<span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">getMessage</span><span style="color: #666666">(</span>String code<span style="color: #666666">)</span>
	<span style="color: #666666">{</span>
		<span style="color: #008000; font-weight: bold">return</span> messageSource<span style="color: #666666">.</span><span style="color: #7D9029">getMessage</span><span style="color: #666666">(</span>code<span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>
	<span style="color: #666666">}</span>

	<span style="color: #008000; font-weight: bold">public</span> String <span style="color: #0000FF">getMessage</span><span style="color: #666666">(</span>String code<span style="color: #666666">,</span> String defaultMsg<span style="color: #666666">)</span>
	<span style="color: #666666">{</span>
		<span style="color: #008000; font-weight: bold">return</span> messageSource<span style="color: #666666">.</span><span style="color: #7D9029">getMessage</span><span style="color: #666666">(</span>code<span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">,</span> defaultMsg<span style="color: #666666">,</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">);</span>
	<span style="color: #666666">}</span>

	<span style="color: #AA22FF">@ModelAttribute</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;authenticatedUser&quot;</span><span style="color: #666666">)</span>
    <span style="color: #008000; font-weight: bold">public</span> AuthenticatedUser <span style="color: #0000FF">authenticatedUser</span><span style="color: #666666">(</span>
    		<span style="color: #AA22FF">@AuthenticationPrincipal</span> AuthenticatedUser
    			authenticatedUser<span style="color: #666666">)</span>
    <span style="color: #666666">{</span>
        <span style="color: #008000; font-weight: bold">return</span> authenticatedUser<span style="color: #666666">;</span>
    <span style="color: #666666">}</span>

	<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">static</span> AuthenticatedUser <span style="color: #0000FF">getCurrentUser</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>

	    Object principal <span style="color: #666666">=</span> SecurityContextHolder
	    					<span style="color: #666666">.</span><span style="color: #7D9029">getContext</span><span style="color: #666666">()</span>
	    					<span style="color: #666666">.</span><span style="color: #7D9029">getAuthentication</span><span style="color: #666666">()</span>
	    					<span style="color: #666666">.</span><span style="color: #7D9029">getPrincipal</span><span style="color: #666666">();</span>
	    <span style="color: #008000; font-weight: bold">if</span> <span style="color: #666666">(</span>principal <span style="color: #008000; font-weight: bold">instanceof</span> AuthenticatedUser<span style="color: #666666">)</span> <span style="color: #666666">{</span>
	    	<span style="color: #008000; font-weight: bold">return</span> <span style="color: #666666">((</span>AuthenticatedUser<span style="color: #666666">)</span> principal<span style="color: #666666">);</span>
	    <span style="color: #666666">}</span>
	    <span style="color: #408080; font-style: italic">// principal object is either null or represents anonymous user -</span>
	    <span style="color: #408080; font-style: italic">// neither of which our domain User object can represent - so return null</span>
	    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">;</span>
	<span style="color: #666666">}</span>

	<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">static</span> <span style="color: #B00040">boolean</span> <span style="color: #0000FF">isLoggedIn</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
	    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #0000FF">getCurrentUser</span><span style="color: #666666">()</span> <span style="color: #666666">!=</span> <span style="color: #008000; font-weight: bold">null</span><span style="color: #666666">;</span>
	<span style="color: #666666">}</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>Observe how we injected Authenticated User object using <strong>@AuthenticationPrincipal</strong> and exposed
as a ModelAttribute so that we can reference it in any of our templates.
Also we have another method which return the AuthenticatedUser so that we can use it in any of our
Controllers to access currently logged in user object, say to set CreatedBy/UpdatedBy objects
on our JPA Entities.</p>
</div>
<div class="paragraph">
<p>Now our Controllers can extend the JCartAdminBaseController class as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px">1
2
3
4
5</div></td><td class="code"><span style="color: #AA22FF">@Controller</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">HomeController</span> <span style="color: #008000; font-weight: bold">extends</span> JCartAdminBaseController
<span style="color: #666666">{</span>
	<span style="color: #666666">...</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_registering_springsecuritydialect_with_thymeleaf">Registering SpringSecurityDialect with Thymeleaf</h3>
<div class="paragraph">
<p>In order to use SpringSecurity dialects features in Thymeleaf templates we need to register
SpringSecurityDialect as an additional dialect. We can do this simply by registering a
SpringSecurityDialect bean.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</div></td><td class="code"><span style="color: #AA22FF">@Configuration</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WebConfig</span> <span style="color: #008000; font-weight: bold">extends</span> WebMvcConfigurerAdapter
<span style="color: #666666">{</span>
	<span style="color: #666666">...</span>

	<span style="color: #AA22FF">@Bean</span>
	<span style="color: #008000; font-weight: bold">public</span> SpringSecurityDialect <span style="color: #0000FF">securityDialect</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
	    <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">SpringSecurityDialect</span><span style="color: #666666">();</span>
	<span style="color: #666666">}</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more info read <a href="http://www.thymeleaf.org/doc/articles/springsecurity.html" class="bare">http://www.thymeleaf.org/doc/articles/springsecurity.html</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_springsecurity_in_thymeleaf_templates">Using SpringSecurity in Thymeleaf Templates</h3>
<div class="paragraph">
<p>Now we can show the Left Nav Menu options by checking whether the logged in user has the Permission or not.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="html"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</div></td><td class="code"><span style="color: #008000; font-weight: bold">&lt;html</span> <span style="color: #7D9029">xmlns=</span><span style="color: #BA2121">&quot;http://www.w3.org/1999/xhtml&quot;</span>
	  <span style="color: #7D9029">xmlns:th=</span><span style="color: #BA2121">&quot;http://www.thymeleaf.org&quot;</span>
	  <span style="color: #7D9029">xmlns:sec=</span><span style="color: #BA2121">&quot;http://www.thymeleaf.org/thymeleaf-extras-springsecurity3&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>

<span style="color: #008000; font-weight: bold">&lt;body&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;span</span> <span style="color: #7D9029">sec:authentication=</span><span style="color: #BA2121">&quot;principal.user.name&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>User<span style="color: #008000; font-weight: bold">&lt;/span&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;p&gt;</span>Welcome <span style="color: #008000; font-weight: bold">&lt;span</span> <span style="color: #7D9029">th:text=</span><span style="color: #BA2121">&quot;${authenticatedUser.user.name}&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>User<span style="color: #008000; font-weight: bold">&lt;/span&gt;</span>!<span style="color: #008000; font-weight: bold">&lt;/p&gt;</span>

	<span style="color: #008000; font-weight: bold">&lt;li</span> <span style="color: #7D9029">sec:authorize=</span><span style="color: #BA2121">&quot;hasRole(&#39;ROLE_MANAGE_CATEGORIES&#39;)&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;a</span> <span style="color: #7D9029">th:href=</span><span style="color: #BA2121">&quot;@{&#39;/categories&#39;}&quot;</span> <span style="color: #7D9029">href=</span><span style="color: #BA2121">&quot;#&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
		<span style="color: #008000; font-weight: bold">&lt;i</span> <span style="color: #7D9029">class=</span><span style="color: #BA2121">&quot;fa fa-folder-open&quot;</span><span style="color: #008000; font-weight: bold">&gt;&lt;/i&gt;</span> <span style="color: #008000; font-weight: bold">&lt;span&gt;</span>Categories<span style="color: #008000; font-weight: bold">&lt;/span&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;/a&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;/li&gt;</span>
    <span style="color: #008000; font-weight: bold">&lt;li</span> <span style="color: #7D9029">sec:authorize=</span><span style="color: #BA2121">&quot;hasRole(&#39;ROLE_MANAGE_PRODUCTS&#39;)&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;a</span> <span style="color: #7D9029">th:href=</span><span style="color: #BA2121">&quot;@{&#39;/products&#39;}&quot;</span> <span style="color: #7D9029">href=</span><span style="color: #BA2121">&quot;#&quot;</span><span style="color: #008000; font-weight: bold">&gt;</span>
		<span style="color: #008000; font-weight: bold">&lt;i</span> <span style="color: #7D9029">class=</span><span style="color: #BA2121">&quot;fa fa-file&quot;</span><span style="color: #008000; font-weight: bold">&gt;&lt;/i&gt;</span> <span style="color: #008000; font-weight: bold">&lt;span&gt;</span>Products<span style="color: #008000; font-weight: bold">&lt;/span&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;/a&gt;</span>
	<span style="color: #008000; font-weight: bold">&lt;/li&gt;</span>

   <span style="color: #008000; font-weight: bold">&lt;/body&gt;</span>
<span style="color: #008000; font-weight: bold">&lt;/html&gt;</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>In our Controllers we can check for Permissions as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px">1
2
3
4
5
6</div></td><td class="code"><span style="color: #AA22FF">@Controller</span>
<span style="color: #AA22FF">@Secured</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;ROLE_MANAGE_CATEGORIES&quot;</span><span style="color: #666666">)</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">CategoryController</span> <span style="color: #008000; font-weight: bold">extends</span> JCartAdminBaseController
<span style="color: #666666">{</span>
	<span style="color: #666666">...</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_registering_a_filter_after_springsecurity_filter">Registering a Filter After SpringSecurity Filter</h3>
<div class="paragraph">
<p>I would like to show the currently selected Left Nav Menu link as Active.
For that I thought of keep tracking the clicked URL and store the ACTIVE_MENU value in model
and then conditionally apply Active style in Thymeleaf template.</p>
</div>
<div class="paragraph">
<p>For this I thought of registering a Filter filter after SpringSecurityFilter.
But SpringSecurity Filter is registered with LOWEST_PRIORITY order automatically.
So we need to get it done using the hack explained here
<a href="http://stackoverflow.com/questions/25957879/filter-order-in-spring-boot" class="bare">http://stackoverflow.com/questions/25957879/filter-order-in-spring-boot</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</div></td><td class="code"><span style="color: #AA22FF">@Configuration</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">WebConfig</span> <span style="color: #008000; font-weight: bold">extends</span> WebMvcConfigurerAdapter
<span style="color: #666666">{</span>
	<span style="color: #666666">...</span>
	<span style="color: #666666">...</span>

	<span style="color: #AA22FF">@Autowired</span>
	<span style="color: #008000; font-weight: bold">private</span> PostAuthorizationFilter postAuthorizationFilter<span style="color: #666666">;</span>

	<span style="color: #AA22FF">@Bean</span>
	<span style="color: #008000; font-weight: bold">public</span> FilterRegistrationBean <span style="color: #0000FF">securityFilterChain</span><span style="color: #666666">(</span>
			<span style="color: #AA22FF">@Qualifier</span><span style="color: #666666">(</span>AbstractSecurityWebApplicationInitializer
							<span style="color: #666666">.</span><span style="color: #7D9029">DEFAULT_FILTER_NAME</span><span style="color: #666666">)</span>
				Filter securityFilter<span style="color: #666666">)</span> <span style="color: #666666">{</span>
	    FilterRegistrationBean registration <span style="color: #666666">=</span>
	    		<span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">FilterRegistrationBean</span><span style="color: #666666">(</span>securityFilter<span style="color: #666666">);</span>
	    registration<span style="color: #666666">.</span><span style="color: #7D9029">setOrder</span><span style="color: #666666">(</span>Integer<span style="color: #666666">.</span><span style="color: #7D9029">MAX_VALUE</span> <span style="color: #666666">-</span> <span style="color: #666666">1);</span>
	    registration<span style="color: #666666">.</span><span style="color: #7D9029">setName</span><span style="color: #666666">(</span>AbstractSecurityWebApplicationInitializer
	    						<span style="color: #666666">.</span><span style="color: #7D9029">DEFAULT_FILTER_NAME</span><span style="color: #666666">);</span>
	    <span style="color: #008000; font-weight: bold">return</span> registration<span style="color: #666666">;</span>
	<span style="color: #666666">}</span>

	<span style="color: #AA22FF">@Bean</span>
	<span style="color: #008000; font-weight: bold">public</span> FilterRegistrationBean <span style="color: #0000FF">PostAuthorizationFilterRegistrationBean</span><span style="color: #666666">()</span> <span style="color: #666666">{</span>
	    FilterRegistrationBean registrationBean <span style="color: #666666">=</span>
	    	<span style="color: #008000; font-weight: bold">new</span> <span style="color: #0000FF">FilterRegistrationBean</span><span style="color: #666666">();</span>
	    registrationBean<span style="color: #666666">.</span><span style="color: #7D9029">setFilter</span><span style="color: #666666">(</span>postAuthorizationFilter<span style="color: #666666">);</span>
	    registrationBean<span style="color: #666666">.</span><span style="color: #7D9029">setOrder</span><span style="color: #666666">(</span>Integer<span style="color: #666666">.</span><span style="color: #7D9029">MAX_VALUE</span><span style="color: #666666">);</span>
	    <span style="color: #008000; font-weight: bold">return</span> registrationBean<span style="color: #666666">;</span>
	<span style="color: #666666">}</span>
<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="java"><table class="pyhltable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</div></td><td class="code"><span style="color: #AA22FF">@Component</span>
<span style="color: #008000; font-weight: bold">public</span> <span style="color: #008000; font-weight: bold">class</span> <span style="color: #0000FF; font-weight: bold">PostAuthorizationFilter</span> <span style="color: #008000; font-weight: bold">extends</span> OncePerRequestFilter
<span style="color: #666666">{</span>
	<span style="color: #AA22FF">@Override</span>
	<span style="color: #008000; font-weight: bold">protected</span> <span style="color: #B00040">void</span> <span style="color: #0000FF">doFilterInternal</span><span style="color: #666666">(</span>
			HttpServletRequest request<span style="color: #666666">,</span>
			HttpServletResponse response<span style="color: #666666">,</span>
			FilterChain chain<span style="color: #666666">)</span>
	<span style="color: #008000; font-weight: bold">throws</span> ServletException<span style="color: #666666">,</span> IOException
	<span style="color: #666666">{</span>
		String uri <span style="color: #666666">=</span> request<span style="color: #666666">.</span><span style="color: #7D9029">getRequestURI</span><span style="color: #666666">();</span>
		String menu <span style="color: #666666">=</span> <span style="color: #666666">...;</span>
		request<span style="color: #666666">.</span><span style="color: #7D9029">setAttribute</span><span style="color: #666666">(</span><span style="color: #BA2121">&quot;CURRENT_MENU&quot;</span><span style="color: #666666">,</span> menu<span style="color: #666666">);</span>

		chain<span style="color: #666666">.</span><span style="color: #7D9029">doFilter</span><span style="color: #666666">(</span>request<span style="color: #666666">,</span> response<span style="color: #666666">);</span>
	<span style="color: #666666">}</span>

<span style="color: #666666">}</span>
</td></tr></table></code></pre>
</div>
</div>
<div class="paragraph">
<p>For complete PostAuthorizationFilter code, please check in github repository
<a href="https://github.com/sivaprasadreddy/jcart" class="bare">https://github.com/sivaprasadreddy/jcart</a>.</p>
</div>
<div class="paragraph">
<p>Now we have Spring Security  configured for our application.</p>
</div>
<div class="paragraph">
<p>In our next posts we will see how to protect Controller methods at class/method level.</p>
</div>
</div>
</div>
</div>
</p>
                                    <div>
                                    	<p><div class="social">
	<a href="https://twitter.com/intent/tweet?status=JCart%3a%20Configuring%20Spring%20Security-http%3a%2f%2fsivalabs.github.io%2fjcart-configuring-spring-security" target="_blank"
		   title="Share on Twitter" class="twitter">
		<span class="fa-stack fa-lg icon-twitter">
          <i class="fa fa-square fa-stack-2x"></i>
          <i class="fa fa-twitter fa-stack-1x"></i>
        </span>
	</a>
		   
	<a href="https://www.facebook.com/sharer/sharer.php?u=http%3a%2f%2fsivalabs.github.io%2fjcart-configuring-spring-security" target="_blank" title="Share on Facebook"
		   class="facebook">		   
		<span class="fa-stack fa-lg icon-facebook">
          <i class="fa fa-square fa-stack-2x"></i>
          <i class="fa fa-facebook fa-stack-1x"></i>
        </span>	   
	</a>
		   
	<a href="https://plus.google.com/share?url=http%3a%2f%2fsivalabs.github.io%2fjcart-configuring-spring-security" target="_blank" title="Share on Google+" class="googleplus">		
		<span class="fa-stack fa-lg icon-gplus">
          <i class="fa fa-square fa-stack-2x"></i>
          <i class="fa fa-google-plus fa-stack-1x"></i>
        </span>	   	
	</a>
		
	<a href="http://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fsivalabs.github.io%2fjcart-configuring-spring-security&title=JCart%3a%20Configuring%20Spring%20Security&source=spf13"
		   target="_blank" title="Share on LinkedIn" class="linkedin">		  
		<span class="fa-stack fa-lg icon-linkedin">
          <i class="fa fa-square fa-stack-2x"></i>
          <i class="fa fa-linkedin fa-stack-1x"></i>
        </span>
	</a>
		   
	<a href="http://www.reddit.com/submit?url=http%3a%2f%2fsivalabs.github.io%2fjcart-configuring-spring-security" target="_blank" title="Share on Reddit" class="reddit">		
		<span class="fa-stack fa-lg icon-reddit">
          <i class="fa fa-square fa-stack-2x"></i>
          <i class="fa fa-reddit-alien fa-stack-1x"></i>
        </span>	
	</a>
</div></p>
                                    	
                                    </div>

                                </div>
                            </div>
                        </div>
                        
                        <div class="media reply_section">
                            <div class="pull-left post_reply text-center">
                                <a href="#"><img src="http://sivalabs.github.io/images/siva.jpg" class="img-circle" alt="" /></a>
                                <ul>
                                    <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                                    <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                                    <li><a href="#"><i class="fa fa-google-plus"></i> </a></li>
                                </ul>
                            </div>
                            <div class="media-body post_reply_content">
                                <h3>K. Siva Prasad Reddy</h3>
                                <p class="lead">A software developer with 10 years of experience in developing Enterprise application using Java platform.</p>
                                <p><strong>Web:</strong> <a href="http://www.sivalabs.in">www.sivalabs.in</a></p>
                            </div>
                        </div> 
                        <aside id=comments>
    <div><h2> Comments </h2></div>
    <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'sivalabs';
    var disqus_identifier = 'http:\/\/sivalabs.github.io\/jcart-configuring-spring-security';
    var disqus_title = 'JCart: Configuring Spring Security';
    var disqus_url = 'http:\/\/sivalabs.github.io\/jcart-configuring-spring-security';

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</aside>
                        

                    </div>

                <aside class="col-md-3">
                    

<div id="sidebar">

<div class="widget">
	<h2>K. Siva Prasad Reddy</h2>
	<img class="authorpic" src="http://sivalabs.github.io/images/Siva-1.jpg" alt="Siva"/>
	
</div>				



<div class="widget">

	<aside id="subscription">
		<strong>Want to receive new post notifications?</strong>
		<form action="//sivalabs.us9.list-manage.com/subscribe/post?u=a244435ef0378fac204b5a2d4&amp;id=bdded8d3db" 
			  method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" 
			  class="validate" target="_blank" novalidate>
			<p><input type="email" value="" name="EMAIL" class="required email form-control" 
						placeholder="Email" id="mce-EMAIL"></p>
			<input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" 
			class="btn btn-xs btn-primary">
			
		    <div style="position: absolute; left: -5000px;" aria-hidden="true">
				<input type="text" name="b_a244435ef0378fac204b5a2d4_bdded8d3db" tabindex="-1" value="">
			</div>
		    <div class="clear"></div>
		</form>
		
	</aside>

</div>
<div class="widget categories">
    <h2>Latest Posts</h2>
    <div class="row">
        
        <div class="col-sm-12">
            <div class="single_comments">                
                <p><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/jcart-configuring-https-ssltls">JCart: Configuring HTTPS SSL/TLS</a></p>                
            </div>            
        </div>
        
        <div class="col-sm-12">
            <div class="single_comments">                
                <p><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/jcart-admin-reset-password">JCart: Admin Reset Password</a></p>                
            </div>            
        </div>
        
        <div class="col-sm-12">
            <div class="single_comments">                
                <p><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/jcart-admin-forgot-password">JCart: Admin Forgot Password</a></p>                
            </div>            
        </div>
        
        <div class="col-sm-12">
            <div class="single_comments">                
                <p><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/jcart-email-service-setup">JCart: Email Service SetUp</a></p>                
            </div>            
        </div>
        
        <div class="col-sm-12">
            <div class="single_comments">                
                <p><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/jcart-configuring-spring-security">JCart: Configuring Spring Security</a></p>                
            </div>            
        </div>
        
    </div> 
</div>
 

 <div class="widget tags">
     <h2>Tag Cloud</h2>
     <div class="tag-cloud">
     	 
		    <span><a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/blogging">Blogging</a></span>
		  
		    <span><a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/e-commerce">E-Commerce</a></span>
		  
		    <span><a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/java">Java</a></span>
		  
		    <span><a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/jcart">Jcart</a></span>
		  
		    <span><a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/spring">Spring</a></span>
		  
		    <span><a class="btn btn-primary btn-xs readmore" href="http://sivalabs.github.io/tags/springboot">Springboot</a></span>
		           
     </div>
 </div>
   

 <div class="widget categories">
     <h2>Categories</h2>
     <div class="row">
         <div class="col-sm-6">
             <ul class="blog_archieve">
             	
             	 	<li><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/categories/blogging">Blogging</a></li>
	  			
             	 	<li><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/categories/e-commerce">E-Commerce</a></li>
	  			
             	 	<li><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/categories/java">Java</a></li>
	  			
             	 	<li><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/categories/jcart">Jcart</a></li>
	  			
             	 	<li><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/categories/spring">Spring</a></li>
	  			
             	 	<li><i class="fa fa-angle-double-right"></i> <a href="http://sivalabs.github.io/categories/springboot">Springboot</a></li>
	  			
             </ul>
         </div>
     </div>                     
 </div>

</div>       				
                </aside>     

            </div>

         </div>

    </section>
<footer id="footer" class="midnight-blue">
    <div class="container">
        <div class="row">
            <div class="col-sm-12">
                <center>&copy; 2015 <a target="_blank" href="http://www.sivalabs.in">www.sivalabs.in</a>. All Rights Reserved.</center>
            </div>
            
        </div>
    </div>
</footer>

<script src="http://sivalabs.github.io/js/jquery.js"></script>
<script src="http://sivalabs.github.io/js/bootstrap.min.js"></script>
<script src="http://sivalabs.github.io/js/jquery.prettyPhoto.js"></script>
<script src="http://sivalabs.github.io/js/jquery.isotope.min.js"></script>
<script src="http://sivalabs.github.io/js/main.js"></script>
<script src="http://sivalabs.github.io/js/wow.min.js"></script>


  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-71296890-1', 'auto');
  ga('send', 'pageview');
</script>

 
</body>
</html>

